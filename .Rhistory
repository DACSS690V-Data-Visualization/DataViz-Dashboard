main.title.size = 1.3,  # Adjust the size of the title
main.title.position = "center",  # Title alignment: "center", "left", or "right"
title = "Paid by Credit Cards & Checks",  # Subtitle
title.size = 0.8,  # Adjust subtitle size
title.position = c("left", "bottom"),  # Subtitle position
legend.outside = TRUE,  # Place the legend outside the map
legend.title.size = 1,  # Adjust the legend title size
legend.text.size = 0.75  # Adjust the legend text size
)
saveRDS(del3Draft, file = "del3Draft.rds")
# deliverable 4  ------------------------------------
readRDS("del3Draft.rds")
#Making an interactive map
del3Draft <- tm_shape(FinalbostonZips) +
tm_polygons("Average",
palette = "plasma",
title = "The Average") +
tm_view(set.view = c(-71.0589, 42.3601, 10)) +
tm_layout(
main.title = "A Map of Average Political Contributions in Boston by Zip Codes",
main.title.size = 1.3,  # Adjust the size of the title
main.title.position = "center",  # Title alignment: "center", "left", or "right"
title = "For Payment made by Credit Cards & Checks",  # Subtitle
title.size = 0.8,  # Adjust subtitle size
title.position = c("left", "bottom"),  # Subtitle position
legend.outside = TRUE,  # Place the legend outside the map
legend.title.size = 1,  # Adjust the legend title size
legend.text.size = 0.75  # Adjust the legend text size
)
del3Draft <- tm_shape(FinalbostonZips) +
tm_polygons("Average",
palette = "plasma",
title = "The Average") +
tm_view(set.view = c(-71.0589, 42.3601, 10)) +
tm_layout(
main.title = "A Map of Average Political Contributions in Boston by Zip Codes",
main.title.size = 1.3,  # Adjust the size of the title
main.title.position = "center",  # Title alignment: "center", "left", or "right"
title = "For Payment made by Credit Cards & Checks",  # Subtitle
title.size = 0.8,  # Adjust subtitle size
title.position = c("left", "bottom"),  # Subtitle position
legend.outside = TRUE,  # Place the legend outside the map
legend.title.size = 1,  # Adjust the legend title size
legend.text.size = 0.75  # Adjust the legend text size
)
saveRDS(del3Draft, file = "del3Draft.rds")
readRDS("del3Draft.rds")
#Making an interactive map
del3Draft <- tm_shape(FinalbostonZips) +
tm_polygons("Average",
palette = "plasma",
title = "The Average") +
tm_view(set.view = c(-71.0589, 42.3601, 10)) +
tm_layout(
main.title = "A Map of Average Political Contributions in Boston by Zip Codes",
main.title.size = 1.3,  # Adjust the size of the title
main.title.position = "center",  # Title alignment: "center", "left", or "right"
title = "For Payment made by Credit Cards & Checks",  # Subtitle
title.size = 1,  # Adjust subtitle size
title.position = c("left", "bottom"),  # Subtitle position
legend.outside = TRUE,  # Place the legend outside the map
legend.title.size = 1,  # Adjust the legend title size
legend.text.size = 0.75  # Adjust the legend text size
)
saveRDS(del3Draft, file = "del3Draft.rds")
readRDS("del3Draft.rds")
# save del3Draft ----------------------------------------------------------
#Making an interactive map
del3Draft <- tm_shape(FinalbostonZips) +
tm_polygons("Average",
palette = "plasma",
title = "The Average") +
tm_view(set.view = c(-71.0589, 42.3601, 10)) +
tm_layout(
main.title = "A Map of Average Political Contributions in Boston by Zip Codes",
main.title.size = 1.3,  # Adjust the size of the title
main.title.position = "center",  # Title alignment: "center", "left", or "right"
title = "For Payment made by Credit Cards & Checks",  # Subtitle
title.size = 1.5,  # Adjust subtitle size
title.position = c("left", "bottom"),  # Subtitle position
legend.outside = TRUE,  # Place the legend outside the map
legend.title.size = 1,  # Adjust the legend title size
legend.text.size = 0.75  # Adjust the legend text size
)
saveRDS(del3Draft, file = "del3Draft.rds")
readRDS("del3Draft.rds")
#Making an interactive map
del3Draft <- tm_shape(FinalbostonZips) +
tm_polygons("Average",
palette = "plasma",
title = "The Average") +
tm_view(set.view = c(-71.0589, 42.3601, 10)) +
tm_layout(
main.title = "A Map of Average Political Contributions in Boston by Zip Codes",
main.title.size = 1.3,  # Adjust the size of the title
main.title.position = "center",  # Title alignment: "center", "left", or "right"
title = "For Payment made by Credit Cards & Checks",  # Subtitle
title.size = 1,  # Adjust subtitle size
title.position = c("left", "bottom"),  # Subtitle position
legend.outside = TRUE,  # Place the legend outside the map
legend.title.size = 1,  # Adjust the legend title size
legend.text.size = 0.75  # Adjust the legend text size
)
saveRDS(del3Draft, file = "del3Draft.rds")
readRDS("del3Draft.rds")
#creating a choropleth map
Cggplot_map <- function(data, var, title, subtitle) {
ggplot(data) +
geom_sf(aes(fill = !!sym(var)), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(title = title,
subtitle = subtitle,
fill = paste(var, "Contributions"),
caption = "Data source: Massachusetts Office of Campaign and Political Finance") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))}
#creating the second interactive map
Ctmap_interactive <- function(data, var, title) {
tm_shape(data) +
tm_polygons(var, palette = "plasma", title = title, alpha = 0.5) -> tmap_chorop
leaflet_map <- tmap_leaflet(tmap_chorop)
leaflet_map |>
addProviderTiles("OpenStreetMap") |>
addPolygons(data = data, fillOpacity = 0.5, color = "blue", weight = 1)}
#For credit cards
Cggplot_map(FinalbostonZips, "Credit Card",
"Total Credit Card Contributions by Zip Code",
"By Zip Code")
Ctmap_interactive(FinalbostonZips, "Credit Card", "Credit Card Contributions")
#For checks
Cggplot_map(FinalbostonZips, "Check",
"Total Check Contributions by Zip Code",
"By Zip Code")
Ctmap_interactive(FinalbostonZips, "Check", "Check Contributions")
#Layering and combining maps
leaflet_map2 <- tmap_leaflet(tm_shape(FinalbostonZips) +
tm_polygons("Credit Card", palette = "plasma", title = "Credit Card Contributions", alpha = 0.5))
leaflet_map2 |>
addProviderTiles("OpenStreetMap") |>
addPolygons(data = FinalbostonZips, fillOpacity = 0.5, color = "blue", weight = 1, group = "Credit Card") |>
addPolygons(data = FinalbostonZips, fillOpacity = 0.5, color = "red", weight = 1, group = "Check") |>
addLayersControl(
overlayGroups = c("Credit Card", "Check"),
options = layersControlOptions(collapsed = FALSE)
)
#creating a choropleth map
Cggplot_map <- function(data, var, title, subtitle) {
ggplot(data) +
geom_sf(aes(fill = !!sym(var)), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(title = title,
subtitle = subtitle,
fill = paste(var, "Contributions"),
caption = "Data source: Massachusetts Office of Campaign and Political Finance") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))}
#creating the second interactive map
Ctmap_interactive <- function(data, var, title) {
tm_shape(data) +
tm_polygons(var, palette = "plasma", title = title, alpha = 0.5) -> tmap_chorop
leaflet_map <- tmap_leaflet(tmap_chorop)
leaflet_map |>
addProviderTiles("OpenStreetMap") |>
addPolygons(data = data, fillOpacity = 0.5, color = "blue", weight = 1)}
#For credit cards
Cggplot_map(FinalbostonZips, "Credit Card",
"Total Credit Card Contributions by Zip Code",
"By Zip Code")
Ctmap_interactive(FinalbostonZips, "Credit Card", "Contributions")
#For checks
Cggplot_map(FinalbostonZips, "Check",
"Total Check Contributions by Zip Code",
"By Zip Code")
Ctmap_interactive(FinalbostonZips, "Check", "Check Contributions")
#Layering and combining maps
leaflet_map2 <- tmap_leaflet(tm_shape(FinalbostonZips) +
tm_polygons("Credit Card", palette = "plasma", title = "Credit Card Contributions", alpha = 0.5))
leaflet_map2 |>
addProviderTiles("OpenStreetMap") |>
addPolygons(data = FinalbostonZips, fillOpacity = 0.5, color = "blue", weight = 1, group = "Credit Card") |>
addPolygons(data = FinalbostonZips, fillOpacity = 0.5, color = "red", weight = 1, group = "Check") |>
addLayersControl(
overlayGroups = c("Credit Card", "Check"),
options = layersControlOptions(collapsed = FALSE)
)
saveRDS(leaflet_map2, "del4Draft.rds")
saveWidget(leaflet_map2, "del4Draft.html")
readRDS("del4Draft.rds")
#creating a choropleth map
Cggplot_map <- function(data, var, title, subtitle) {
ggplot(data) +
geom_sf(aes(fill = !!sym(var)), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(title = title,
subtitle = subtitle,
fill = paste(var, "Contributions"),
caption = "Data source: Massachusetts Office of Campaign and Political Finance") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))}
#creating the second interactive map
Ctmap_interactive <- function(data, var, title) {
tm_shape(data) +
tm_polygons(var, palette = "plasma", title = title, alpha = 0.5) -> tmap_chorop
leaflet_map <- tmap_leaflet(tmap_chorop)
leaflet_map |>
addProviderTiles("OpenStreetMap") |>
addPolygons(data = data, fillOpacity = 0.5, color = "blue", weight = 1)}
#For credit cards
Cggplot_map(FinalbostonZips, "Credit Card",
"Total Credit Card Contributions by Zip Code",
"By Zip Code")
Ctmap_interactive(FinalbostonZips, "Credit Card", "Credit Card Contributions")
#For checks
Cggplot_map(FinalbostonZips, "Check",
"Total Check Contributions by Zip Code",
"By Zip Code")
Ctmap_interactive(FinalbostonZips, "Check", "Check Contributions")
#Layering and combining maps
leaflet_map2 <- tmap_leaflet(tm_shape(FinalbostonZips) +
tm_polygons("Credit Card", palette = "plasma", title = "Contributions", alpha = 0.5))
leaflet_map2 |>
addProviderTiles("OpenStreetMap") |>
addPolygons(data = FinalbostonZips, fillOpacity = 0.5, color = "blue", weight = 1, group = "Credit Card") |>
addPolygons(data = FinalbostonZips, fillOpacity = 0.5, color = "red", weight = 1, group = "Check") |>
addLayersControl(
overlayGroups = c("Credit Card", "Check"),
options = layersControlOptions(collapsed = FALSE)
)
saveRDS(leaflet_map2, "del4Draft.rds")
saveWidget(leaflet_map2, "del4Draft.html")
readRDS("del4Draft.rds")
readRDS("del3Draft.rds")
library(flexdashboard) # always
readRDS("del4Draft.rds")
library(flexdashboard) # always
readRDS("del1Draft.rds")
readRDS("Option1.rds")
ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average, geometry = geometry), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "Average Contributions by ZIP Code",
subtitle = "Tender Types: Credit Card and Check",
fill = "Average",
caption = "Data source: Massachusetts Office of Campaign and Political Finance"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))
#del3Draft
#saveRDS(del3Draft, file = "del3Draft.rds")
# save del3Draft ----------------------------------------------------------
#Making an interactive map
del3Draft <- tm_shape(FinalbostonZips) +
tm_polygons("Average",
palette = "plasma",
title = "The Average") +
tm_view(set.view = c(-71.0589, 42.3601, 10)) +
tm_layout(
main.title = "A Map of Average Political Contributions in Boston by Zip Codes",
main.title.size = 1.3,
main.title.position = "center",
title = "For Payment made by Credit Cards & Checks",
title.size = 1,
title.position = c("left", "bottom"),
legend.outside = TRUE,
legend.title.size = 1,
legend.text.size = 0.75
)
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
# deliverable 4  ----------------------------------------------------------
#creating a choropleth map
Cggplot_map <- function(data, var, title, subtitle) {
ggplot(data) +
geom_sf(aes(fill = !!sym(var)), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(title = title,
subtitle = subtitle,
fill = paste(var, "Contributions"),
caption = "Data source: Massachusetts Office of Campaign and Political Finance") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))}
#creating the second interactive map
Ctmap_interactive <- function(data, var, title) {
tm_shape(data) +
tm_polygons(var, palette = "plasma", title = title, alpha = 0.5) -> tmap_chorop
leaflet_map <- tmap_leaflet(tmap_chorop)
leaflet_map |>
addProviderTiles("OpenStreetMap") |>
addPolygons(data = data, fillOpacity = 0.5, color = "blue", weight = 1)}
#For credit cards
Cggplot_map(FinalbostonZips, "Credit Card",
"Total Credit Card Contributions by Zip Code",
"By Zip Code")
Ctmap_interactive(FinalbostonZips, "Credit Card", "Credit Card Contributions")
#For checks
Cggplot_map(FinalbostonZips, "Check",
"Total Check Contributions by Zip Code",
"By Zip Code")
Ctmap_interactive(FinalbostonZips, "Check", "Check Contributions")
#Layering and combining maps
leaflet_map2 <- tmap_leaflet(tm_shape(FinalbostonZips) +
tm_polygons("Credit Card", palette = "plasma", title = "Contributions", alpha = 0.5))
leaflet_map2 |>
addProviderTiles("OpenStreetMap") |>
addPolygons(data = FinalbostonZips, fillOpacity = 0.5, color = "blue", weight = 1, group = "Credit Card") |>
addPolygons(data = FinalbostonZips, fillOpacity = 0.5, color = "red", weight = 1, group = "Check") |>
addLayersControl(
overlayGroups = c("Credit Card", "Check"),
options = layersControlOptions(collapsed = FALSE)
)
# save del4Draft ----------------------------------------------------------
saveRDS(leaflet_map2, "del4Draft.rds")
saveWidget(leaflet_map2, "del4Draft.html")
##Plotting -------------------------------------------------------------
#plotting a choropleth with the average in contributions
ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "Average Contributions by ZIP Code",
subtitle = "Tender Types: Credit Card and Check",
fill = "Average",
caption = "Data source: Massachusetts Office of Campaign and Political Finance"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))
# save del3Draft ----------------------------------------------------------
#Making an interactive map
del3Draft <- tm_shape(FinalbostonZips) +
tm_polygons("Average", palette = "plasma", title = "The Average") +
tm_view(set.view = c(-71.0589, 42.3601, 10)) +
tm_layout(
main.title = "A Map of Average Political Contributions in Boston by Zip Codes",
main.title.size = 1.3,
main.title.position = "center",
title = "For Payment made by Credit Cards & Checks",
title.size = 1,
title.position = c("left", "bottom"),
legend.outside = TRUE,
legend.title.size = 1,
legend.text.size = 0.75 )
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
readRDS("del4Draft.rds")
readRDS("del3Draft.rds")
head(FinalbostonZips)
# Ensure the spatial data is valid
if (!st_is_valid(FinalbostonZips)) {
FinalbostonZips <- st_make_valid(FinalbostonZips)
}
# Check if any geometries are invalid
invalid_geometries <- !st_is_valid(FinalbostonZips)
# If there are invalid geometries, make them valid
if (any(invalid_geometries)) {
FinalbostonZips <- st_make_valid(FinalbostonZips)
}
# Now proceed with the tmap map creation
del3Draft <- tm_shape(FinalbostonZips) +
tm_polygons("Average", palette = "plasma", title = "The Average") +
tm_view(set.view = c(-71.0589, 42.3601, 10)) +
tm_layout(
main.title = "A Map of Average Political Contributions in Boston by Zip Codes",
main.title.size = 1.3,
main.title.position = "center",
title = "For Payment made by Credit Cards & Checks",
title.size = 1,
title.position = c("left", "bottom"),
legend.outside = TRUE,
legend.title.size = 1,
legend.text.size = 0.75
)
# Check if the tmap object was created successfully before saving
if (inherits(del3Draft, "tmap")) {
# Save as .rds
saveRDS(del3Draft, file = "del3Draft.rds")
# Save as an interactive html file
saveWidget(del3Draft, "del3Draft.html")
} else {
warning("Error in creating the tmap object.")
}
# Check if any geometries are invalid
invalid_geometries <- !st_is_valid(FinalbostonZips)
# If there are invalid geometries, make them valid
if (any(invalid_geometries)) {
FinalbostonZips <- st_make_valid(FinalbostonZips)
}
# Now proceed with the tmap map creation
del3Draft <- tm_shape(FinalbostonZips) +
tm_polygons("Average", palette = "plasma", title = "The Average") +
tm_view(set.view = c(-71.0589, 42.3601, 10)) +
tm_layout(
main.title = "A Map of Average Political Contributions in Boston by Zip Codes",
main.title.size = 1.3,
main.title.position = "center",
title = "For Payment made by Credit Cards & Checks",
title.size = 1,
title.position = c("left", "bottom"),
legend.outside = TRUE,
legend.title.size = 1,
legend.text.size = 0.75
)
# Check if the tmap object was created successfully before saving
if (inherits(del3Draft, "tmap")) {
# Save as .rds
saveRDS(del3Draft, file = "del3Draft.rds")
# Save as an interactive html file
saveWidget(del3Draft, "del3Draft.html")
} else {
warning("Error in creating the tmap object.")
}
# Check if any geometries are invalid
invalid_geometries <- !st_is_valid(FinalbostonZips)
# If there are invalid geometries, make them valid
if (any(invalid_geometries)) {
FinalbostonZips <- st_make_valid(FinalbostonZips)
}
# Now proceed with the tmap map creation
del3Draft <- tm_shape(FinalbostonZips) +
tm_polygons("Average", palette = "plasma", title = "The Average") +
tm_view(set.view = c(-71.0589, 42.3601, 10)) +
tm_layout(
main.title = "A Map of Average Political Contributions in Boston by Zip Codes",
main.title.size = 1.3,
main.title.position = "center",
title = "For Payment made by Credit Cards & Checks",
title.size = 1,
title.position = c("left", "bottom"),
legend.outside = TRUE,
legend.title.size = 1,
legend.text.size = 0.75
)
# Check if the tmap object was created successfully before saving
if (inherits(del3Draft, "tmap")) {
# Save as .rds
saveRDS(del3Draft, file = "del3Draft.rds")
# Save as an interactive html file
saveWidget(del3Draft, "del3Draft.html")
} else {
warning("Error in creating the tmap object.")
}
invalid_geometries <- !st_is_valid(FinalbostonZips)
# Print indices of invalid geometries
if (any(invalid_geometries)) {
print(which(invalid_geometries))
# Fix invalid geometries
FinalbostonZips <- st_make_valid(FinalbostonZips)
}
invalid_geometries <- !st_is_valid(FinalbostonZips)
# Print indices of invalid geometries
if (any(invalid_geometries)) {
print(which(invalid_geometries))
# Fix invalid geometries
FinalbostonZips <- st_make_valid(FinalbostonZips)
}
# Create a simple map with just borders
del3Draft <- tm_shape(FinalbostonZips) +
tm_borders()
# Print the map to check if it's working
print(del3Draft)
del3Draft <- tm_shape(FinalbostonZips) +
tm_polygons("Average", palette = "plasma", title = "Average Contributions") +
tm_layout(main.title = "Average Political Contributions by Zip Code")
# Print the final map
print(del3Draft)
readRDS("del3Draft.rds")
readRDS("del3Draft.rds")
ggplot(Updated_bostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "Average Contributions by ZIP Code",
subtitle = "Tender Types: Credit Card and Check",
fill = "Average",
caption = "Data source: Massachusetts Office of Campaign and Political Finance"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))
# save del3Draft ----------------------------------------------------------
#Making an interactive map
del3Draft <- tm_shape(Updated_bostonZips) +
tm_polygons("Average", palette = "plasma", title = "The Average") +
tm_view(set.view = c(-71.0589, 42.3601, 10)) +
tm_layout(
main.title = "A Map of Average Political Contributions in Boston by Zip Codes",
main.title.size = 1.3,
main.title.position = "center",
title = "For Payment made by Credit Cards & Checks",
title.size = 1,
title.position = c("left", "bottom"),
legend.outside = TRUE,
legend.title.size = 1,
legend.text.size = 0.75 )
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
del3Draft <- tm_shape(Updated_bostonZips) +
tm_polygons("Average", palette = "plasma", title = "The Average") +
tm_view(set.view = c(-71.0589, 42.3601, 10)) +
tm_layout(
main.title = "A Map of Average Political Contributions in Boston by Zip Codes",
main.title.size = 1.3,
main.title.position = "center",
title = "For Payment made by Credit Cards & Checks",
title.size = 1,
title.position = c("left", "bottom"),
legend.outside = TRUE,
legend.title.size = 1,
legend.text.size = 0.75 )
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
readRDS("del3Draft.rds")
readRDS("del3Draft.rds")
