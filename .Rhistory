coord_flip() +
labs(title = "Total Contributions by Tender Type",
x = "Tender Type",
y = "Contribution Amount") +
theme_minimal()
#Viewing the relationships between contribution amount and zip code of the person
ggplot(bostonCont, aes(x = Zip, y = Amount)) +
geom_point(alpha = 0.5, aes(color = Tender_Type)) +
labs(title = "Contribution Amounts by Zip Code",
x = "Zip Code",
y = "Contribution Amount",
color = "Tender Type") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 50))
#Checking how the contribution per tender type and visualizing it
# Calculate total contribution amount per tender type
total_by_tender <- bostonCont |>
group_by(Tender_Type) |>
summarize(TotalAmount = sum(Amount, na.rm = TRUE)) |>
arrange(desc(TotalAmount))
# Print the result
print(total_by_tender)
#data viz to see the output
ggplot(total_by_tender, aes(x = reorder(Tender_Type, -TotalAmount), y = TotalAmount, fill = Tender_Type)) +
geom_col() +
labs(title = "Total Contribution Amount by Tender Type",
x = "Tender Type",
y = "Total Amount") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 40,hjust = 1))
#heatmap to show contribution by tender type
bostonCont |>
group_by(Zip, Tender_Type) |>
summarize(TotalContrib = sum(Amount, na.rm = TRUE)) |>
ggplot(aes(x = Tender_Type, y = Zip, fill = TotalContrib)) +
geom_tile() +
scale_fill_viridis_c(option = "brown") +
labs(title = "Contributions by Tender Type and Zip Code",
x = "Tender Type",
y = "Zip Code",
fill = "Total Contribution") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 40,hjust = 1))
##Cleaning data for the visualization
aggregBoston <- bostonCont |>
filter(Tender_Type %in% c("Credit Card", "Check")) |>
group_by(Tender_Type, Zip) |>
summarize(TotalContrib = sum(Amount, na.rm = TRUE), .groups = "drop") |>
tidyr::pivot_wider(names_from = Tender_Type, values_from = TotalContrib, values_fill = 0)
# Join with the overall total contributions for prioritization
aggregBoston <- aggregBoston |>
mutate(
# Average based on Credit Card and Check
Average = (`Credit Card` + Check) / 2,
# Rate based on Credit Card as a percentage of the total contributions for Credit Card + Check
Rate = ifelse(`Credit Card` + Check > 0, `Credit Card` / (`Credit Card` + Check) * 100, NA),
# Proportion based on Check contributions as a proportion of Credit Card contributions
Proportion = ifelse(`Credit Card` > 0, Check / `Credit Card`, NA))
# Calculate total contributions by Zip (for all tender types)
total_aggreg <- bostonCont |>
group_by(Zip) |>
summarize(TotalAllTypes = sum(Amount, na.rm = TRUE), .groups = "drop")
#Merge total tender type data with the aggregated Credit Card and Check
aggregBoston <- aggregBoston |>
left_join(total_aggreg, by = "Zip") |>
mutate(
# Calculate Credit Card and Check as a percentage of all contributions
CreditCardPctOfTotal = ifelse(TotalAllTypes > 0, `Credit Card` / TotalAllTypes * 100, NA),
CheckPctOfTotal = ifelse(TotalAllTypes > 0, Check / TotalAllTypes * 100, NA))
#View(aggregBoston)
head(bostonZips)
Updated_bostonZips <- bostonZips |>
left_join(aggregBoston, by = c("ZIP5" = "Zip"))
#View(Updated_bostonZips)
#Filtering down to only columns needed for visualizations
FinalbostonZips <- Updated_bostonZips |>
select(
ZIP5,
geometry,
Shape_Length,
Shape_Area,
Check,
`Credit Card`,
Average,
Rate,
Proportion,
TotalAllTypes,
CreditCardPctOfTotal,
CheckPctOfTotal )
#making sure the data updated correctly
head(FinalbostonZips)
#Now to remove NA values for cleaner viz
FinalbostonZips <- FinalbostonZips|>
filter(!is.na(Check))
#viewing the newly clean data
view(FinalbostonZips)
##Plotting -------------------------------------------------------------
#plotting a choropleth with the average in contributions
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "Showing only Payment made by Credit Cards & Checks",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))
del3Draft
# save del3Draft ----------------------------------------------------------
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
# deliverable 4  ----------------------------------------------------------
#creating a choropleth map
Cggplot_map <- function(data, var, title, subtitle) {
ggplot(data) +
geom_sf(aes(fill = !!sym(var)), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(title = title,
subtitle = subtitle,
fill = paste(var, "Contributions"),
caption = "Data source: Massachusetts Office of Campaign and Political Finance") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))}
#creating the second interactive map
Ctmap_interactive <- function(data, var, title) {
tm_shape(data) +
tm_polygons(var, palette = "plasma", title = title, alpha = 0.5) -> tmap_chorop
leaflet_map <- tmap_leaflet(tmap_chorop)
leaflet_map |>
addProviderTiles("OpenStreetMap") |>
addPolygons(data = data, fillOpacity = 0.5, color = "blue", weight = 1)}
#For credit cards
Cggplot_map(FinalbostonZips, "Credit Card",
"Total Credit Card Contributions by Zip Code",
"By Zip Code")
Ctmap_interactive(FinalbostonZips, "Credit Card", "Credit Card Contributions")
#For checks
Cggplot_map(FinalbostonZips, "Check",
"Total Check Contributions by Zip Code",
"By Zip Code")
Ctmap_interactive(FinalbostonZips, "Check", "Check Contributions")
#Layering and combining maps
leaflet_map2 <- tmap_leaflet(tm_shape(FinalbostonZips) +
tm_polygons("Credit Card", palette = "plasma", title = "Contributions", alpha = 0.5))
leaflet_map2 |>
addProviderTiles("OpenStreetMap") |>
addPolygons(data = FinalbostonZips, fillOpacity = 0.5, color = "blue", weight = 1, group = "Credit Card") |>
addPolygons(data = FinalbostonZips, fillOpacity = 0.5, color = "red", weight = 1, group = "Check") |>
addLayersControl(
overlayGroups = c("Credit Card", "Check"),
options = layersControlOptions(collapsed = FALSE)
)
# save del4Draft ----------------------------------------------------------
saveRDS(leaflet_map2, "del4Draft.rds")
saveWidget(leaflet_map2, "del4Draft.html")
#plotting a choropleth with the average in contributions
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "Downtown Boston in the Led with contributions",
subtitle = "Showing only Payment made by Credit Cards & Checks",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "Downtown Boston in the Led with contributions",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))
del3Draft
# save del3Draft ----------------------------------------------------------
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
readRDS("del3Draft.rds")
readRDS("del3Draft.rds")
readRDS("del3Draft.rds")
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "Downtown Boston in the Led with contributions",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))
del3Draft
# save del3Draft ----------------------------------------------------------
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
setwd("~/Documents/UMass - DACSS/Courses/DACSS 690V/DataViz-Dashboard")
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "Downtown Boston in the Led with contributions",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))
del3Draft
# save del3Draft ----------------------------------------------------------
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
readRDS("del3Draft.rds")
readRDS("del3Draft.rds")
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "North Downtown Boston and NW in the Led with contributions",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))
del3Draft
readRDS("del3Draft.rds")
readRDS("del3Draft.rds")
readRDS("del3Draft.rds")
#plotting a choropleth with the average in contributions
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "North Downtown Boston and Northwest in the Led with contributions",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))
del3Draft
# save del3Draft ----------------------------------------------------------
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
readRDS("del3Draft.rds")
readRDS("del3Draft.rds")
#plotting a choropleth with the average in contributions
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "North Downtown Boston and Northwest in the Led with contributions",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance",
x = NULL,
y = NULL,
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))
del3Draft
# save del3Draft ----------------------------------------------------------
##Plotting -------------------------------------------------------------
#plotting a choropleth with the average in contributions
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "North Downtown Boston and Northwest in the Led with contributions",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance",
x = NULL,
y = NULL,
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 40))
del3Draft
# save del3Draft ----------------------------------------------------------
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
readRDS("del3Draft.rds")
readRDS("del3Draft.rds")
#plotting a choropleth with the average in contributions
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "North Downtown Boston and Northwest in the Led with contributions",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance",
x = NULL,
y = NULL,
) +
theme_minimal() +
theme(
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank())
del3Draft
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "North Downtown Boston and Northwest in the Led with contributions",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance",
x = NULL,
y = NULL,
) +
theme_minimal() +
theme(
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank())
del3Draft
# save del3Draft ----------------------------------------------------------
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "With North Downtown Boston and Northwest in the Led with Contributions",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance",
x = NULL,
y = NULL,
) +
theme_minimal() +
theme(
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank())
del3Draft
# save del3Draft ----------------------------------------------------------
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
readRDS("del3Draft.rds")
readRDS("del3Draft.rds")
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "With North Downtown Boston and Northwest in the Led with Contributions",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance (Credit Card and Check Payments)",
x = NULL,
y = NULL,
) +
theme_minimal() +
theme(
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank())
del3Draft
# save del3Draft ----------------------------------------------------------
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
readRDS("del3Draft.rds")
readRDS("del3Draft.rds")
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "With North Downtown Boston and Northwest in the Led with Contributions",
fill = "The Average Dollar Amount",
caption = "Source: MA Office of Campaign and Political Finance (Credit Card and Check Payments)",
x = NULL,
y = NULL,
) +
theme_minimal() +
theme(
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank())
del3Draft
# save del3Draft ----------------------------------------------------------
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
readRDS("del3Draft.rds")
readRDS("del3Draft.rds")
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "With North Downtown Boston and Northwest in the Led with Contributions",
fill = "The Average Dollar Amount",
caption = "Source: MA Office of Campaign and Political Finance (Credit Card and Check Payments)",
x = NULL,
y = NULL,
) +
theme_minimal() +
theme(
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank())
del3Draft
# save del3Draft ----------------------------------------------------------
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
#Plotting -------------------------------------------------------------
#plotting a choropleth with the average in contributions
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "With North Downtown Boston and Northwest in the Led with Contributions (Credit Card and Check Payments)",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance",
x = NULL,
y = NULL,
) +
theme_minimal() +
theme(
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank())
del3Draft
# save del3Draft ----------------------------------------------------------
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
#Plotting -------------------------------------------------------------
#plotting a choropleth with the average in contributions
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "With North Downtown Boston and Northwest in the Led with Contributions (Credit Card and Check Payments)",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance",
x = NULL,
y = NULL,
) +
theme_minimal() +
theme(
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank())
del3Draft
# save del3Draft ----------------------------------------------------------
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
readRDS("del3Draft.rds")
readRDS("del3Draft.rds")
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "With North Downtown Boston and Northwest in the Led with Contributions\nCredit Card and Check Payments",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance",
x = NULL,
y = NULL,
) +
theme_minimal() +
theme(
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank())
del3Draft
# save del3Draft ----------------------------------------------------------
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
del3Draft <- ggplot(FinalbostonZips) +
geom_sf(aes(fill = Average), color = "white") +
scale_fill_viridis_c(option = "plasma", na.value = "grey") +
labs(
title = "A Map of Average Political Contributions in Boston by Zip Codes",
subtitle = "With North Downtown Boston and Northwest in the Led with Contributions\n Showing only Credit Card and Check Payments",
fill = "The Average Dollar Amount",
caption = "Source: Massachusetts Office of Campaign and Political Finance",
x = NULL,
y = NULL,
) +
theme_minimal() +
theme(
axis.text = element_blank(),
axis.ticks = element_blank(),
axis.title = element_blank(),
panel.grid = element_blank())
del3Draft
# save del3Draft ----------------------------------------------------------
#Save the viz
saveRDS(del3Draft, file = "del3Draft.rds")
readRDS("del3Draft.rds")
readRDS("del3Draft.rds")
